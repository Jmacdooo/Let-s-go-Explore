<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>My Forever Dog — Yosemite Walk</title>
<style>
  body{
    margin:0;
    background:#000;
    overflow:hidden;
    font-family: system-ui, -apple-system, sans-serif;
  }
  canvas{
    display:block;
    width:100vw;
    height:100vh;
  }
  #controls{
    position:fixed;
    left:10px;
    top:10px;
    z-index:10;
    background:rgba(255,255,255,.9);
    padding:8px 10px;
    border-radius:12px;
    box-shadow:0 4px 12px rgba(0,0,0,.2);
  }
  button{
    padding:8px 10px;
    margin:2px;
    border-radius:10px;
    border:none;
    cursor:pointer;
    font-weight:600;
    background:#ffb703;
  }
  #msg{
    position:fixed;
    left:50%;
    bottom:12px;
    transform:translateX(-50%);
    background:rgba(255,255,255,.95);
    padding:8px 14px;
    border-radius:14px;
    box-shadow:0 4px 12px rgba(0,0,0,.2);
    font-size:14px;
    max-width:90vw;
    text-align:center;
  }
</style>
</head>
<body>

<div id="controls">
  <button id="leftBtn">⬅ Walk</button>
  <button id="stopBtn">⏸ Stop</button>
  <button id="rightBtn">Walk ➡</button>
</div>

<div id="msg">Walk to explore Yosemite!</div>

<canvas id="game"></canvas>

<script>
// =======================
// Canvas setup
// =======================
const canvas = document.getElementById("game");
const ctx    = canvas.getContext("2d");
const msgEl  = document.getElementById("msg");

function resize(){
  canvas.width  = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

function dogGroundY(){ return canvas.height - 80; }

// =======================
// Load images
// =======================
const bgImg  = new Image();
bgImg.src    = "assets/yosemite.png";

const dogImg = new Image();
dogImg.src   = "assets/dog_walk.png";   // strip with multiple dogs

let bgReady  = false;
let dogReady = false;

bgImg.onload  = () => { bgReady = true; };
dogImg.onload = () => {
  dogReady = true;
  DOG_FRAME_W = dogImg.width / DOG_FRAMES;  // compute from real image
  DOG_FRAME_H = dogImg.height;
};

// walking strip info (we’ll adjust width after load)
let DOG_FRAMES   = 6;       // you have 6 dogs in the strip
let DOG_FRAME_W  = 256;
let DOG_FRAME_H  = 256;
const DOG_SCALE  = 0.8;
const DOG_SPEED  = 260;     // pixels per second
const ANIM_FPS   = 8;

// =======================
// Dog + controls
// =======================
const dog = {
  x: canvas.width * 0.2,
  dir: -1,       // -1 = left, 1 = right; art faces LEFT by default
  state: "idle", // "idle" or "walk"
  frame: 0,
  frameTime: 0
};

const leftBtn  = document.getElementById("leftBtn");
const rightBtn = document.getElementById("rightBtn");
const stopBtn  = document.getElementById("stopBtn");

leftBtn.onclick = () => {
  dog.dir = -1;
  dog.state = "walk";
  msgEl.textContent = "Walking left along the trail…";
};

rightBtn.onclick = () => {
  dog.dir = 1;
  dog.state = "walk";
  msgEl.textContent = "Walking right along the trail…";
};

stopBtn.onclick = () => {
  dog.state = "idle";
  msgEl.textContent = "Tap a button or use arrow keys to walk.";
};

window.addEventListener("keydown", e => {
  if (e.key === "ArrowLeft")  leftBtn.onclick();
  if (e.key === "ArrowRight") rightBtn.onclick();
  if (e.key === " ")          stopBtn.onclick();
});

// =======================
// Update
// =======================
let lastTime = performance.now();

function update(dt){
  // move dog
  if (dog.state === "walk") {
    dog.x += dog.dir * DOG_SPEED * dt;
  }

  // stay on screen
  dog.x = Math.max(80, Math.min(canvas.width - 80, dog.x));

  // animate legs
  if (dog.state === "walk" && dogReady) {
    const frameDur = 1 / ANIM_FPS;
    dog.frameTime += dt;
    while (dog.frameTime >= frameDur) {
      dog.frameTime -= frameDur;
      dog.frame = (dog.frame + 1) % DOG_FRAMES;
    }
  } else {
    dog.frame = 0;
  }
}

// =======================
// Draw
// =======================
function drawBackground(){
  if (bgReady) {
    const img = bgImg;
    const imgW = img.width;
    const imgH = img.height;
    const imgAspect = imgW / imgH;
    const canvasAspect = canvas.width / canvas.height;

    let drawW, drawH, drawX, drawY;
    if (canvasAspect > imgAspect) {
      drawW = canvas.width;
      drawH = canvas.width / imgAspect;
      drawX = 0;
      drawY = (canvas.height - drawH) / 2;
    } else {
      drawH = canvas.height;
      drawW = canvas.height * imgAspect;
      drawX = (canvas.width - drawW) / 2;
      drawY = 0;
    }
    ctx.drawImage(img, drawX, drawY, drawW, drawH);
  } else {
    ctx.fillStyle = "#bde0fe";
    ctx.fillRect(0,0,canvas.width,canvas.height);
  }

  // ground strip so paws are clear
  const gy = dogGroundY();
  ctx.fillStyle = "rgba(255,255,255,0.25)";
  ctx.fillRect(0, gy, canvas.width, canvas.height - gy);
}

function drawDog(){
  if (!dogReady) return;

  const gy = dogGroundY();
  const sx = dog.frame * DOG_FRAME_W;
  const sy = 0;

  const dw = DOG_FRAME_W * DOG_SCALE;
  const dh = DOG_FRAME_H * DOG_SCALE;
  const dx = dog.x - dw / 2;
  const dy = gy - dh;

  ctx.save();

  // Art faces LEFT by default -> flip when walking RIGHT
  if (dog.dir === 1) {
    ctx.scale(-1, 1);
    ctx.drawImage(
      dogImg,
      sx, sy, DOG_FRAME_W, DOG_FRAME_H,
      -dx - dw, dy,
      dw, dh
    );
  } else {
    ctx.drawImage(
      dogImg,
      sx, sy, DOG_FRAME_W, DOG_FRAME_H,
      dx, dy,
      dw, dh
    );
  }

  ctx.restore();
}

// =======================
// Main loop
// =======================
function loop(time){
  const dt = (time - lastTime) / 1000;
  lastTime = time;

  update(dt);
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawBackground();
  drawDog();

  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);
</script>
</body>
</html>
